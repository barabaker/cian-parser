# https://www.cian.ru/

##  Как это работает
Данные получаем с endpointa https://api.cian.ru/search-engine/v1/search-offers-mobile-site/
передав в *POST* запросе следующие данные   

```
    payload = {
        "jsonQuery": {
            "_type": f"{work.offer_type}sale",
            "engine_version": {"type": "term", "value": 2},
            'region': {
                'type': 'terms',
                'value': work.subject_id,
            },
            "bbox": {
                "type": "term",
                "value": work.bbox
            },
            "page": {"type": "term", "value": work.page},
        }
    }
```

```python
{'text': 'Москва', 'id': 1}
{'text': 'Московская область', 'id': 4593}
{'text': 'Санкт-Петербург', 'id': 2}
{'text': 'Ленинградская область', 'id': 4588}
{'text': 'Адыгея', 'id': 4553}
{'text': 'Алтай (Республика)', 'id': 4554}
{'text': 'Алтайский край', 'id': 4555}
{'text': 'Амурская область', 'id': 4556}
{'text': 'Архангельская область', 'id': 4557}
{'text': 'Астраханская область', 'id': 4558}
{'text': 'Башкортостан', 'id': 4560}
{'text': 'Белгородская область', 'id': 4561}
{'text': 'Брянская область', 'id': 4562}
{'text': 'Бурятия', 'id': 4563}
{'text': 'Владимирская область', 'id': 4564}
{'text': 'Волгоградская область', 'id': 4565}
{'text': 'Вологодская область', 'id': 4566}
{'text': 'Воронежская область', 'id': 4567}
{'text': 'Дагестан', 'id': 4568}
{'text': 'Еврейская АО', 'id': 4569}
{'text': 'Забайкальский край', 'id': 187450}
{'text': 'Ивановская область', 'id': 4570}
{'text': 'Ингушетия', 'id': 4571}
{'text': 'Иркутская область', 'id': 4572}
{'text': 'Кабардино-Балкария', 'id': 4573}
{'text': 'Калининградская область', 'id': 4574}
{'text': 'Калмыкия', 'id': 4575}
{'text': 'Калужская область', 'id': 4576}
{'text': 'Камчатский край', 'id': 4577}
{'text': 'Карачаево-Черкесия', 'id': 4578}
{'text': 'Карелия', 'id': 4579}
{'text': 'Кемеровская область', 'id': 4580}
{'text': 'Кировская область', 'id': 4581}
{'text': 'Коми', 'id': 4582}
{'text': 'Костромская область', 'id': 4583}
{'text': 'Краснодарский край', 'id': 4584}
{'text': 'Красноярский край', 'id': 4585}
{'text': 'Крым', 'id': 181462}
{'text': 'Курганская область', 'id': 4586}
{'text': 'Курская область', 'id': 4587}
{'text': 'Липецкая область', 'id': 4589}
{'text': 'Магаданская область', 'id': 4590}
{'text': 'Марий Эл', 'id': 4591}
{'text': 'Мордовия', 'id': 4592}
{'text': 'Мурманская область', 'id': 4594}
{'text': 'Ненецкий АО', 'id': 4595}
{'text': 'Нижегородская область', 'id': 4596}
{'text': 'Новгородская область', 'id': 4597}
{'text': 'Новосибирская область', 'id': 4598}
{'text': 'Омская область', 'id': 4599}
{'text': 'Оренбургская область', 'id': 4600}
{'text': 'Орловская область', 'id': 4601}
{'text': 'Пензенская область', 'id': 4602}
{'text': 'Пермский край', 'id': 4603}
{'text': 'Приморский край', 'id': 4604}
{'text': 'Псковская область', 'id': 4605}
{'text': 'Ростовская область', 'id': 4606}
{'text': 'Рязанская область', 'id': 4607}
{'text': 'Самарская область', 'id': 4608}
{'text': 'Саратовская область', 'id': 4609}
{'text': 'Саха (Якутия)', 'id': 4610}
{'text': 'Сахалинская область', 'id': 4611}
{'text': 'Свердловская область', 'id': 4612}
{'text': 'Севастополь', 'id': 184723}
{'text': 'Северная Осетия-Алания', 'id': 4613}
{'text': 'Смоленская область', 'id': 4614}
{'text': 'Ставропольский край', 'id': 4615}
{'text': 'Тамбовская область', 'id': 4617}
{'text': 'Татарстан', 'id': 4618}
{'text': 'Тверская область', 'id': 4619}
{'text': 'Томская область', 'id': 4620}
{'text': 'Тульская область', 'id': 4621}
{'text': 'Тыва', 'id': 4622}
{'text': 'Тюменская область', 'id': 4623}
{'text': 'Удмуртия', 'id': 4624}
{'text': 'Ульяновская область', 'id': 4625}
{'text': 'Хабаровский край', 'id': 4627}
{'text': 'Хакасия', 'id': 4628}
{'text': 'Ханты-Мансийский АО', 'id': 4629}
{'text': 'Челябинская область', 'id': 4630}
{'text': 'Чечня', 'id': 4631}
{'text': 'Чувашия', 'id': 4633}
{'text': 'Чукотский АО', 'id': 4634}
{'text': 'Ямало-Ненецкий АО', 'id': 4635}
{'text': 'Ярославская область', 'id': 4636}
```

После 56 страницы данные перестают приходить как это можно обойти следующим образом делим bbox на более мелкие части что-бы в запрашиваемой области карты было не более **1568 offers**


```python
# получаем дома, дачи, участки, коттеджи в Ярославской области
import requests

headers = {
    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
    'accept-language': 'ru,en-US;q=0.9,en;q=0.8',
    'upgrade-insecure-requests': '1',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36',
}

params = {
    'bbox': '50.639877,77.889018,54.45311,87.170489',
    'deal_type': 'sale',
    'offer_type': 'suburban',
    'parentOrigin': 'https://www.cian.ru',
}

url = 'https://api.cian.ru/mobile-search-frontend/v1/get-results-for-map'

response = requests.get(url = url, params = params, headers = headers)

```
